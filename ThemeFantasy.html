<!DOCTYPE html>
<html>
  <head>
    <title>Book Review Website</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="Theme Or Genre/ThemeFantasy.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <header class="header">
      <div class="left">
        <img src="Main Image/final.png" alt="" class="logo" />
      </div>
      <div class="middle">
        <form action="" class="s">
          <input
            type="search"
            placeholder="Search"
            class="search"
            id="search-item"
          />
          <button type="submit" id="search-button">
            <i class="fa-solid fa-magnifying-glass"></i>
          </button>
        </form>
      </div>
      <div class="right">
        <ul>
          <a href="index.htm" class=""> <li>Home</li></a>
          <a href="Theme.html" class=""><li>Genre</li></a>
          <a href="contactFinal.htm" class=""><li>Contact Us</li></a>
          <a href="About.html" class=""> <li>About Us</li></a>
          <a href="#" id="user"
            ><li><i class="fa-solid fa-user"></i></li
          ></a>
        </ul>
        <div class="bars" id="menu-icon"><i class="fa-solid fa-bars"></i></div>
      </div>
    </header>
    <section class="genre">
      <div
        class="color-overlay d-flex justify-content-center align-items-center"
      >
        <h2 id="currentTheme">FANTASY</h2>
      </div>
      <div class="genre-container" id="container"></div>
    </section>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script>
      var nav = document.querySelector("nav");
      window.addEventListener("scroll", function () {
        if (window.pageYOffset > 100) {
          nav.classList.add("bg-dark", "shadow");
        } else {
          nav.classList.remove("bg-dark", "shadow");
        }
      });
    </script>
    <footer class="bg-dark text-white pt-5 pb-4">
      <div class="containFooter text-center text-md-left">
        <div class="row text-center text-md-left">
          <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
            <h5 class="text-uppercase mb-4 font-weight-bold text-primary">
              Company Name
            </h5>
            <p class="text-white">BookBuzz</p>
            <p class="text-white">
              Discover BookBuzz, your one-stop destination for book lovers.
              Immerse yourself in captivating stories, lively discussions, and
              curated recommendations. Join our vibrant community and let your
              love for books soar. Get buzzing about books with BookBuzz today!
            </p>
          </div>
          <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mt-3">
            <h5 class="text-uppercase mb-4 font-weight-bold text-primary">
              Available Genre
            </h5>
            <p>
              <a href="#" class="text-white" style="text-decoration: none"
                >Fantasy</a
              >
            </p>
            <p>
              <a href="#" class="text-white" style="text-decoration: none"
                >Mystery</a
              >
            </p>
            <p>
              <a href="#" class="text-white" style="text-decoration: none"
                >Science Fiction</a
              >
            </p>
            <p>
              <a href="#" class="text-white" style="text-decoration: none"
                >Romance</a
              >
            </p>
          </div>

          <div class="col-md-4 col-lg-2 col-xl-2 mx-auto mt-3">
            <h5 class="text-uppercase mb-4 font-weight-bold text-primary">
              Contact Us
            </h5>
            <p class="text-white">
              <i class="fas fa-home mr-3 text-white"></i> Phuentsholing,Chukha
              2023 Bhutan
            </p>
            <p class="text-white">
              <i class="fas fa-envelope mr-3 text-white"></i>
              Bookbuzz023@gmail.com
            </p>
            <p class="text-white">
              <i class="fas fa-phone mr-3 text-white"></i> +975 17864932
            </p>
            <p class="text-white">
              <i class="fas fa-printer mr-3 text-white"></i>+01 385 633 77
            </p>
          </div>
        </div>
        <hr class="mb-4" />
        <div class="row align-items-center">
          <div class="col-md-7 col-lg-8">
            <p class="text-white">
              Copyright &copy All rights reserved by:
              <a href="#" style="text-decoration: none">
                <strong class="text-primary">The provider</strong>
              </a>
            </p>
          </div>
          <div class="col-md-5 col-lg-4">
            <div class="text-center text-md-right"></div>
            <ul class="list-unstyled list-inline">
              <li class="list-inline-item">
                <a
                  href=""
                  class="btn-floating btn-sm text-white"
                  style="font-size: 23px"
                  ><i class="fab fa-facebook text-white"></i
                ></a>
              </li>
              <li class="list-inline-item">
                <a
                  href=""
                  class="btn-floating btn-sm text-white"
                  style="font-size: 23px"
                  ><i class="fab fa-twitter text-white"></i
                ></a>
              </li>
              <li class="list-inline-item">
                <a
                  href=""
                  class="btn-floating btn-sm text-white"
                  style="font-size: 23px"
                  ><i class="fab fa-google text-white"></i
                ></a>
              </li>
              <li class="list-inline-item">
                <a
                  href=""
                  class="btn-floating btn-sm text-white"
                  style="font-size: 23px"
                  ><i class="fab fa-linkedin text-white"></i
                ></a>
              </li>
              <li class="list-inline-item">
                <a
                  href=""
                  class="btn-floating btn-sm text-white"
                  style="font-size: 23px"
                  ><i class="fab fa-youtube text-white"></i
                ></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </body>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      get,
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyA-uwO2oey_TBYu_Xpwms3VcBO068Ic0a8",
      authDomain: "miniproject-1ca20.firebaseapp.com",
      databaseURL:
        "https://miniproject-1ca20-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "miniproject-1ca20",
      storageBucket: "miniproject-1ca20.appspot.com",
      messagingSenderId: "56934343229",
      appId: "1:56934343229:web:c457a2cc065b0b6847c054",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    //This is for the hamburger menu
    let menu = document.querySelector("#menu-icon");
    let navlist = document.querySelector(".right ul ");

    menu.onclick = () => {
      // menu.classList.toggle("bx-x");
      navlist.classList.toggle("open");
    };

    // Retrieve the search query parameter from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const GenreBookQuery = urlParams.get("q");

    //Changing current theme
    const currentTheme = document.getElementById("currentTheme");
    currentTheme.innerHTML = GenreBookQuery;
    //Referencing the database
    const genreref = ref(database, "Books/");

    // Getting book data from the database
    get(genreref)
      .then((snapshot) => {
        if (snapshot.exists()) {
          const bookData = snapshot.val();

          Object.keys(bookData).forEach((BookID) => {
            const book = bookData[BookID];
            const genre = book.genre;
            console.log(genre);
            if (genre.toLowerCase() === GenreBookQuery.toLowerCase()) {
              const imageUrl = book.imageUrl;
              const title = book.title;
              const smallDescription = book.smallDescription;
              //Initializing the elements
              const div = document.createElement("div");
              const img = document.createElement("img");
              const h5 = document.createElement("h5");
              const p = document.createElement("p");
              const a = document.createElement("a");

              //Giving class names to the elements
              div.className = "genre-item";
              h5.className = "card-title";
              p.className = "card-text";
              a.className = "btn btn-outline-light";
              //Adding things to the element
              img.src = imageUrl;
              h5.textContent = title;
              p.textContent = smallDescription;
              a.textContent = "View Book";
              a.setAttribute("data-card-id", title);
              //Adding the created element in the grid
              const container = document.getElementById("container");
              div.appendChild(img);
              div.appendChild(h5);
              div.appendChild(p);
              div.appendChild(a);
              container.appendChild(div);
            }
          });
        } else {
          console.log("No genre data found.");
        }
      })
      .catch((error) => {
        console.error("Error retrieving genre data:", error);
      });

    //When the a tag or view books is clicked
    const container = document.getElementById("container");
    container.addEventListener("click", function (event) {
      if (event.target.matches("a")) {
        const clickedCardA = event.target;
        const bookQuery = clickedCardA.getAttribute("data-card-id");
        event.preventDefault();
        window.location.href =
          "BookPage.html?q=" + encodeURIComponent(bookQuery);
        console.log("A has been clicked: " + bookQuery);
      }
    });

    //Function menu
    document.querySelector("#user").addEventListener("click", function () {
      checkUser();
    });
    function checkUser() {
      onAuthStateChanged(auth, (user) => {
        if (user) {
          window.location.href = "profilePage.html";
        } else {
          window.location.href = "Login.html";
        }
      });
    }
    // Reference to your Firebase Realtime Database
    const databaseRef = ref(database, "Books");
    const searchButton = document.getElementById("search-button");
    const searchInput = document.getElementById("search-item");
    var SearchTerm;
    searchButton.addEventListener("click", function (event) {
      event.preventDefault();
      SearchTerm = searchInput.value;
      window.location.href =
        "newsearch.html?q=" + encodeURIComponent(SearchTerm);
    });
  </script>
</html>
